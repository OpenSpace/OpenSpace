local createDeck = function (identifier)
    return {
        SlideIdentifiers = {},
        IdentifierPrefix = identifier,
        CurrentSlideIndex = 1
    }
end

local removeDeck = function (deck)
    for i, identifier in pairs(deck.SlideIdentifiers) do
        openspace.removeScreenSpaceRenderable(identifier)
    end
end

local addSlide = function (deck, path)
    local index = #deck.SlideIdentifiers + 1
    local identifier = deck.IdentifierPrefix .. index

    openspace.addScreenSpaceRenderable({
        Type = "ScreenSpaceImageLocal",
        Identifier = identifier,
        Name = identifier,
        TexturePath = path
    })

    deck.SlideIdentifiers[#deck.SlideIdentifiers + 1] = identifier
end


local setCurrentSlide = function (deck, index) 
    deck.CurrentSlideIndex = index

    for i, identifier in pairs(deck.SlideIdentifiers) do
        local opacity = 0
        if (index == i) then
            opacity = 1
        end
        openspace.setPropertyValueSingle(
            "ScreenSpace." .. identifier .. ".Alpha", opacity)
    end
end

local goToNextSlide = function (deck) 
    setCurrentSlide(deck, deck.CurrentSlideIndex + 1)
end

local goToPreviousSlide = function (deck) 
    setCurrentSlide(deck, deck.CurrentSlideIndex - 1)
end

asset.export('createDeck', createDeck)
asset.export('removeDeck', removeDeck)
asset.export('addSlide', addSlide)
asset.export('setCurrentSlide', setCurrentSlide)
asset.export('goToNextSlide', goToNextSlide)
asset.export('goToPreviousSlide', goToPreviousSlide)
