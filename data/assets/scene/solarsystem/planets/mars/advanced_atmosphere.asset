local transforms = asset.require('./mars')
local assetHelper = asset.require('util/asset_helper')

local Atmosphere = {
    Identifier = "MarsAtmosphere",
    Parent = transforms.Mars.Identifier,
    Renderable = {
        Type = "RenderableAtmosphere",
        Atmosphere = {
            -- Atmosphere and planet radius in Km
            AtmosphereRadius = 3463.17495,
            PlanetRadius = 3386.190,
            
            --AtmosphereRadius = 6451.137,
            --PlanetRadius     = 6368.137,
            
            PlanetAverageGroundReflectance = 0.1,
            GroundRadianceEmittion = 0.37,
            SunIntensity = 13.1,
            MieScatteringExtinctionPropCoefficient = 0.23862,
            -- Advanced Atmosphere Mode Enabled
            AdvancedMode = true,
            UseOnlyAdvancedMie = true,
            Rayleigh = {
                Coefficients = {
                    -- Wavelengths are given in 10^-9m
                    Wavelengths = { 680, 550, 440 },
                    -- Reflection coefficients are given in cm^-1
                    Scattering = { 19.918E-3, 13.57E-3, 5.75E-3 }
                    -- In Rayleigh scattering, the coefficients of 
                    -- absorption and scattering are the same.
                    -- Paper Values:
                    --Scattering = { 0.5E-3, 2.32E-3, 5.58E-3 }
                    -- Paper Values CO2 (calculated using lambda 680, 550, 440 nm and n(lambda) = 1.00044661, 1.00045019, 1.00045558):
                    --Scattering = { 1.287149E-3, 3.055976E-3, 7.640644E-3 }
                },
                -- Thichkness of atmosphere if its density were uniform, in Km
                H_R = 8.0,
                
                -- Advanced Parameters
                RayleighRealRefract = {1.00044661, 1.00045019, 1.00045558},
                RayleighComplexRefract = {0.0, 0.0, 0.0},
                Polarizability = 0.09,
                -- N Rayleigh x10^25,
                NRayleigh = 277.90,
                -- N Rayliegh Absorption x 10^16 m
                NRayleighAbs = 0.0,
                -- Rayleigh Absorption Particle Radius x10-10 m
                RayleighAbsParticleRadius = 0.0,
            },
            -- Default
            Mie = {
                Coefficients = {
                    -- Reflection coefficients are given in cm^-1
                    --Scattering = { 53.61771e-3, 53.61771e-3, 53.61771e-3 },
                    -- Paper Values
                    Scattering = { 19.918E-3, 13.57E-3, 5.75E-3 },
                    -- Extinction coefficients are a fraction of the Scattering coefficients
                    Extinction = { 53.61771e-3/0.98979, 53.61771e-3/0.98979, 53.61771e-3/0.98979 }
                },
                -- Mie Height scale (atmosphere thickness for constant density) in Km
                H_M = 11.1,
                --H_M = 42.01,
                -- Mie Phase Function Value (G e [-1.0, 1.0]. 
                -- If G = 1.0, Mie phase function = Rayleigh Phase Function)
                G = 0.85,
                
                -- Advanced Parameters
                MieRealRefract = {1.52, 1.52, 1.52},
                MieComplexRefract = {0.001, 0.006, 0.013},
                Kappa = {0.31, 0.16, 0.07},
                -- N Mie x10^6
                NMie = 0.02,
                -- Mie Mean Particle Radius x10^-6 m
                MieMeanParticleRadius = 1.6,
                -- 2 to 10
                Turbidity = 1.6,
                -- 2 to 6
                JungeExponent = 4.0,
                --G1    = {0.889, 0.53, 0.71},
                G1    = {0.03, 0.4, 0.67},
                G2    = {0.094, 0.094, 0.094},
                Alpha = {0.743, 0.743, 0.743}
            },
            Image = {
                ToneMapping = jToneMapping,
                Exposure = 0.4,
                Background = 1.8,
                Gamma = 1.85
            },
            Debug = {
                -- PreCalculatedTextureScale is a float from 1.0 to N, with N > 0.0 and N in Naturals (i.e., 1, 2, 3, 4, 5....)
                PreCalculatedTextureScale = 1.0,
                SaveCalculatedTextures = false
            }
        }
    },
    GUI = {
        Name = "Mars Atmosphere",
        Path = "/Solar System/Planets/Mars"
    }
}



assetHelper.registerSceneGraphNodesAndExport(asset, { Atmosphere })
