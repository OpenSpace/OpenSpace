local transforms = asset.require("./transforms_magnetosphere")
local transferFunction = asset.localResource("./CMR-illuminance2.txt")
local transferFunction2 = asset.localResource("C:/OpenSpace/OpenSpace/data/assets/scene/solarsystem/heliosphere/bastille_day/transferfunctions/density-fieldlines.txt")


local fieldlinesDirectory = asset.syncedResource({
  Name = "Magnetosphere 2012 event",
  Type = "HttpSynchronization",
  Identifier = "magnetosphere_2012_event",
  Version = 1
})

local fieldlineTest = {
  Identifier = "NewRenderableMagnetosphereTest1",
  Parent = transforms.GSMReferenceFrame.Identifier,
  InteractionSphere = 6380000,
  Renderable = {
    Type = "RenderableFieldlinesSequence",
    SourceFolder = fieldlinesDirectory,
    InputFileType = "Osfls",
    SimulationModel = "Batsrus",
    ColorMethod = "ByQuantity",
    ColorQuantity = 4, --speed
    ColorTableRanges = {{50,300}},
    ColorMinMaxRange = {0, 1000},
    ColorTablePaths = {transferFunction},
    ShowAtAllTimes = true,
    MaskingEnabled = true,
    MaskingQuantity = 5,      -- corresponds to "topology"
    MaskingRange = {-0, 0},  --closed only
  },
  GUI = {
    Path = "/Solar System/heliosphere",
    Name = "TestingNewRenderable"
  }
}

asset.onInitialize(function()
  openspace.addSceneGraphNode(fieldlineTest)
end)

asset.onDeinitialize(function()
  openspace.removeSceneGraphNode(fieldlineTest)
end)

asset.export(fieldlineTest)

asset.meta = {
  Name = "Static generic magnetosphere of fieldlines",
  Version = "1.1",
  Description = "Generic static magnetosphere fieldlines. Actual timestep 2012-07-14T00-00-00-000. Defaultly colored by speed; 50-300 km/s",
  Author = "CCMC",
  URL = "",
  License = "CC-BY"
}
