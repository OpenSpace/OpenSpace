local assetHelper = asset.require('util/asset_helper')
local transforms = asset.require('../../sun/heliosphere/mas/bastille_day/transforms')

--local fieldlinesDirectory = "C:/Users/elono/Documents/OpenSpace/data/earthMagnetoSphere"
local fieldlinesDirectory = asset.syncedResource({
    Name = "Magnetosphere 2012 event",
    Type = "HttpSynchronization",
    Identifier = "magnetosphere_2012_event",
    Version = 1
})

--local sunRadius = 6.957E8
local earthRadius = 6378137

-- Fieldlies from binaries
local earthMagnetosphere = {
    Identifier = "Earths_Magnetosphere",
    Parent = transforms.GSMReferenceFrame.Identifier,
    --Parent = sunTransforms.SunIAU.Identifier,
    Renderable = {
        Type = "RenderableFieldlinesSequence",
        SourceFolder = fieldlinesDirectory,
        -- FlowEnabled = false,
        LineWidth = 3.0,
        AlphaBlendlingEnabled = false,
        InputFileType = "osfls",
        --ColorTablePaths = {
        --    masDensityColorTable,
        --    masVelocityColorTable,
        --},
        --ColorTableMinMax = {
        --    { 0, 1000000 },
        --    { 100, 2000 }
        --},
        --maskingEnabled = true,
        --MaskingRanges = {0.0, 0.0}, -- this seem to map it to an int =0 which correspond to the topology=closed (fieldlines)
        LoadAtRuntime = true,
        ScaleToMeters = 1.0,
        SecondsBefore = 24*60*60*365*100,
        SecondsAfter = 24*60*60*365*100,
        --SimulationModel = "mas",
        Color = {
            Uniform = {1.0, 0.725, 0.75, 1}
        }
    },
    GUI = {
        Path = "/Solar System/Planets/Earth",
        Name = "Magnetosphere"
    },
    --Transform = {
    --    Scale = {
    --        Type = "StaticScale",
    --        Scale = earthRadius
    --    } 
    --}
} 

assetHelper.registerSceneGraphNodesAndExport(asset, { earthMagnetosphere })

asset.meta = {
    Name = "Predictive Science Inc. Fieldlines Bastille Day",
    Version = "1.0",
    Description = " Magnetic fieldlines for the bastille day CME event ",
    Author = "OpenSpace team",
    URL = "https://dx.doi.org/10.3847/1538-4357/aab36d",
    License = ""
}
