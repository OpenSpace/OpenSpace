-- Color Mapped
-- This example creates a vector field where vector colors are determined by a
-- color mapping.
--
-- The color mapping is applied to the magnitude of each vector, which is computed
-- internally from the vector components. The color mapping range is automatically
-- computed from the minimum and maximum magnitude values present in the dataset.
--
-- Note that the color map is loaded from another asset. This is a utility asset that
-- includes some common color maps for general usage.

local colormaps = asset.require("util/default_colormaps")

-- Load the volume data from OpenSpace servers

local volume = asset.resource({
  Name = "Vector Field - Example",
  Type = "HttpSynchronization",
  Identifier = "vectorfield_volume",
  Version = 1
})

local Node = {
  Identifier = "RenderableVectorField_Example_ColorMapped",
  Renderable = {
    Type = "RenderableVectorField",
    VolumeFile = volume .. "vectorfield_16x16x16_magnitude_radial.bin",

    MinDomain = { -5000.0, -5000.0, -5000.0 },
    MaxDomain = { 5000.0, 5000.0, 5000.0 },
    Dimensions = { 16, 16, 16 },
    VectorFieldScale = 8.0,

    Coloring = {
      ColorMode = "Magnitude";
      ColorMapFile = colormaps.Uniform.Viridis,
      FixedColor = { 1.0, 0.7, 0.5, 1.0 }
    }
  },
  GUI = {
    Name = "RenderableVectorField - Color Mapped",
    Path = "/Examples"
  }
}

asset.onInitialize(function()
  openspace.addSceneGraphNode(Node)
end)

asset.onDeinitialize(function()
  openspace.removeSceneGraphNode(Node)
end)
